# 'CSRF' 7월 7일 (8일에 작성) 2025년

📖 작성자: [kimsee8200](https://github.com/kimsee8200)
## CSRF 문제

CSRF(Cross Site Request Forgery, 크로스 사이트 요청 변조)는 로그인 정보를 가지고 있는 사용자를 통해 악의적인 요청을 전송하도록 하여 사용자에게 피해를 입히는 보안 문제이다.

예를 들어 사용자가 은행 사이트에 로그아웃 하지 않은 상태로 악의적인 웹사이트에 접근하여 공격자의 악의적인 요청을 전송하는 form을 누르게 되면 그 요청이 서버측에서 받아져 사용자의 정보가 유출되거나, 물질상의 피해를 입을 수 있다.

## 이 문제를 어떻게 해결해야하는가?
CSRF는 위조한 요청과 정상적으로 보내진 요청을 구분하지 못해 발생하는 문제로서, 정상적인 요청임을 증명하는 수단을 넣어 서버가 이를 구분 할 수 있도록 한다. 

그것이 바로 '동기화 패턴 토큰 (Synchronizer Pattern Token)' 이다. 이는 서버측에서 만들어줘 이것을 클라이언트에 전달한다. 클라이언트는 매 요청마다 이 토큰을 사용하여 요청을 날려주면, 서버에서 이를 세션에 저장되어있는 토큰과 일치하는지 검증하여 요청을 처리한다. 참고로 이 토큰은 정상적인 '웹 페이지'에 저장이 되는 것이다. 쿠키 등에 저장되는 것이 다르고, 인증과는 별개의 문제이다.

## 토큰의 재발급

동기화 패턴 토큰은 한 세션당 하나의 고유의 값을 가지고 있다. 세션이 만료될 때 마다 재발급을 할 수도 있고, 한번의 요청마다 재발급을 할 수도 있다. 이것은 개발자와 고객이 조율하여 적용해야 한다.

## Spring에서의 CSRF
스프링에서는 이것을 매우 간단하게 적용할 수 있다. 바로 Spring security 를 활용하여 CSRF 디폴트 설정을 하면 된다. [Spring DOCS](https://docs.spring.io/spring-security/reference/features/exploits/csrf.html#csrf) 여기에 자세히 나와 있으니 한번 번역기라도 돌리면서 확인해 보자.